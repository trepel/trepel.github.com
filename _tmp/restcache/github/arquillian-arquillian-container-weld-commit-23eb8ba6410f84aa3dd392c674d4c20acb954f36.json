{"commit":{"author":{"login":"ALRubinger","name":"Andrew Lee Rubinger","email":"alr@alrubinger.com"},"url":"/arquillian/arquillian-container-weld/commit/23eb8ba6410f84aa3dd392c674d4c20acb954f36","id":"23eb8ba6410f84aa3dd392c674d4c20acb954f36","parents":[{"id":"278e7d4455e8f1fe4a2faa44ba03bc00542d06e6"}],"message":"[ARQ-819] Do not use type-checking to supply a WebArchiveClassLoader; instead check for the spec suffix \".war\"","tree":"04445dc02c332d062142846a2f7e97574e04ecda","modified":[{"diff":"@@ -48,6 +48,11 @@\n  */\n public class WeldEEMockContainer implements DeployableContainer<WeldEEMockConfiguration>\n {\n+   /**\n+    * Suffix denoting a web archive is being used\n+    */\n+   private static final String SUFFIX_WEB_ARCHIVE = \".war\"; \n+\n    @Inject @ContainerScoped\n    private InstanceProducer<WeldEEMockConfiguration> configuration;\n    \n@@ -136,7 +141,7 @@ public void undeploy(Descriptor descriptor) throws DeploymentException\n    }\n \n     private ShrinkWrapClassLoader getClassLoader(Archive<?> archive) {\n-        return (archive instanceof WebArchive) ? new WebArchiveClassLoader(archive.getClass().getClassLoader(), archive)\n+        return (archive.getName().endsWith(SUFFIX_WEB_ARCHIVE)) ? new WebArchiveClassLoader(archive.getClass().getClassLoader(), archive)\n                 : new ShrinkWrapClassLoader(archive.getClass().getClassLoader(), archive);\n     }\n ","filename":"weld-ee-embedded-1.1/src/main/java/org/jboss/arquillian/container/weld/ee/embedded_1_1/WeldEEMockContainer.java"}],"committer":{"login":"aslakknutsen","name":"Aslak Knutsen","email":"aslak@redhat.com"},"committed_date":"2012-06-13T06:19:20-07:00","authored_date":"2012-03-15T17:19:48-07:00"}}