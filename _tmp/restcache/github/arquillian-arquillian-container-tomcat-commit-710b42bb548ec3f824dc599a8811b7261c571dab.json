{"commit":{"tree":"f656d80c47b6b66e57a67943390ea6d74c6101ad","committed_date":"2012-08-02T05:10:55-07:00","authored_date":"2012-08-02T04:16:09-07:00","committer":{"login":"aslakknutsen","email":"aslak@redhat.com","name":"Aslak Knutsen"},"url":"/arquillian/arquillian-container-tomcat/commit/710b42bb548ec3f824dc599a8811b7261c571dab","added":["tomcat-common/src/main/java/org/jboss/arquillian/container/tomcat/AdditionalJavaOptionsParser.java","tomcat-common/src/test/java/org/jboss/arquillian/container/tomcat/AdditionalJavaOptionsParserTest.java"],"parents":[{"id":"4f21d417450019e8046717cead083df4d1d4ce74"}],"message":"ARQ-1044 Clean up javaVmArguments property by removing tags and line breaks\n\nThis allow multiline/pretty formatted configuration:\n\n<property name=\"javaVmArguments\">\n  -Xms500M\n  -Xmx1000M\n</property>","author":{"login":"trepel","email":"trepel@redhat.com","name":"Tomas Repel"},"modified":[{"diff":"@@ -33,6 +33,13 @@\n             <artifactId>arquillian-container-test-spi</artifactId>\n         </dependency>\n \n+        <!--  JUnit -->\n+        <dependency>\n+            <groupId>junit</groupId>\n+            <artifactId>junit</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+\n     </dependencies>\n \n </project>","filename":"tomcat-common/pom.xml"},{"diff":"@@ -33,6 +33,7 @@\n import org.jboss.arquillian.container.spi.client.container.LifecycleException;\n import org.jboss.arquillian.container.spi.client.protocol.ProtocolDescription;\n import org.jboss.arquillian.container.spi.client.protocol.metadata.ProtocolMetaData;\n+import org.jboss.arquillian.container.tomcat.AdditionalJavaOptionsParser;\n import org.jboss.arquillian.container.tomcat.CommonTomcatManager;\n import org.jboss.arquillian.container.tomcat.ProtocolMetadataParser;\n import org.jboss.arquillian.container.tomcat.Validate;\n@@ -101,14 +102,7 @@ public void start() throws LifecycleException\n          cmd.add(\"-Dcom.sun.management.jmxremote.ssl=false\");\n          cmd.add(\"-Dcom.sun.management.jmxremote.authenticate=false\");\n \n-         if (ADDITIONAL_JAVA_OPTS != null) {\n-        \t  for (String opt : ADDITIONAL_JAVA_OPTS.split(\" \")) {\n-\n-        \t    if ( !(opt.trim()).equals(\"\") ) {\n-        \t\t  cmd.add(opt);\n-        \t    }\n-        \t  }\n-         }\n+         cmd.addAll(AdditionalJavaOptionsParser.parse(ADDITIONAL_JAVA_OPTS));\n \n          String absolutePath = new File(CATALINA_HOME).getAbsolutePath();\n          String CLASS_PATH = absolutePath + \"/bin/bootstrap.jar\" + System.getProperty(\"path.separator\");","filename":"tomcat-managed-5.5/src/main/java/org/jboss/arquillian/container/tomcat/managed_5_5/TomcatManagedContainer.java"},{"diff":"@@ -4,7 +4,8 @@\n     <container qualifier=\"tomcat\" default=\"true\">\n         <configuration>\n             <property name=\"catalinaHome\">${CATALINA_HOME:target/apache-tomcat-5.5.33}</property>\n-            <property name=\"javaVmArguments\">-Xmx1024m -XX:MaxPermSize=512m</property>\n+            <property name=\"javaVmArguments\">-Xmx1024m\n+            -XX:MaxPermSize=512m</property>\n             <property name=\"jmxPort\">8089</property>\n             <property name=\"bindHttpPort\">8080</property>\n             <!-- [ARQ-630]. We'll use credentials with ISO-8859-1 characters for testing. ","filename":"tomcat-managed-5.5/src/test/resources/arquillian.xml"},{"diff":"@@ -33,6 +33,7 @@\n import org.jboss.arquillian.container.spi.client.container.LifecycleException;\n import org.jboss.arquillian.container.spi.client.protocol.ProtocolDescription;\n import org.jboss.arquillian.container.spi.client.protocol.metadata.ProtocolMetaData;\n+import org.jboss.arquillian.container.tomcat.AdditionalJavaOptionsParser;\n import org.jboss.arquillian.container.tomcat.CommonTomcatManager;\n import org.jboss.arquillian.container.tomcat.ProtocolMetadataParser;\n import org.jboss.arquillian.container.tomcat.Validate;\n@@ -108,14 +109,7 @@ public void start() throws LifecycleException {\n             cmd.add(\"-Dcom.sun.management.jmxremote.ssl=false\");\n             cmd.add(\"-Dcom.sun.management.jmxremote.authenticate=false\");\n \n-            if (ADDITIONAL_JAVA_OPTS != null) {\n-            \t  for (String opt : ADDITIONAL_JAVA_OPTS.split(\" \")) {\n-\n-            \t    if ( !(opt.trim()).equals(\"\") ) {\n-            \t\t  cmd.add(opt);\n-            \t    }\n-            \t  }\n-            }\n+            cmd.addAll(AdditionalJavaOptionsParser.parse(ADDITIONAL_JAVA_OPTS));\n \n             String absolutePath = new File(CATALINA_HOME).getAbsolutePath();\n             String CLASS_PATH = absolutePath + \"/bin/bootstrap.jar\" + System.getProperty(\"path.separator\");","filename":"tomcat-managed-6/src/main/java/org/jboss/arquillian/container/tomcat/managed_6/TomcatManagedContainer.java"},{"diff":"@@ -4,7 +4,9 @@\n     <container qualifier=\"tomcat\" default=\"true\">\n         <configuration>\n             <property name=\"catalinaHome\">${CATALINA_HOME:target/apache-tomcat-6.0.32}</property>\n-            <property name=\"javaVmArguments\">-Xmx1024m -XX:MaxPermSize=512m</property>\n+            <property name=\"javaVmArguments\">-Xmx1024m\n+\"-XX:MaxPermSize=512m\"\n+            </property>\n             <property name=\"jmxPort\">8089</property>\n             <property name=\"bindHttpPort\">8080</property>\n             <!-- [ARQ-630]. We'll use credentials with ISO-8859-1 characters for testing. ","filename":"tomcat-managed-6/src/test/resources/arquillian.xml"},{"diff":"@@ -32,6 +32,7 @@\n import org.jboss.arquillian.container.spi.client.container.LifecycleException;\n import org.jboss.arquillian.container.spi.client.protocol.ProtocolDescription;\n import org.jboss.arquillian.container.spi.client.protocol.metadata.ProtocolMetaData;\n+import org.jboss.arquillian.container.tomcat.AdditionalJavaOptionsParser;\n import org.jboss.arquillian.container.tomcat.ProtocolMetadataParser;\n import org.jboss.arquillian.container.tomcat.Validate;\n import org.jboss.shrinkwrap.api.Archive;\n@@ -106,14 +107,7 @@ public void start() throws LifecycleException {\n             cmd.add(\"-Dcom.sun.management.jmxremote.ssl=false\");\n             cmd.add(\"-Dcom.sun.management.jmxremote.authenticate=false\");\n \n-            if (ADDITIONAL_JAVA_OPTS != null) {\n-            \t  for (String opt : ADDITIONAL_JAVA_OPTS.split(\" \")) {\n-\n-            \t    if ( !(opt.trim()).equals(\"\") ) {\n-            \t\t  cmd.add(opt);\n-            \t    }\n-            \t  }\n-            }\n+            cmd.addAll(AdditionalJavaOptionsParser.parse(ADDITIONAL_JAVA_OPTS));\n \n             String absolutePath = new File(CATALINA_HOME).getAbsolutePath();\n             String CLASS_PATH = absolutePath + \"/bin/bootstrap.jar\" + System.getProperty(\"path.separator\");","filename":"tomcat-managed-7/src/main/java/org/jboss/arquillian/container/tomcat/managed_7/TomcatManagedContainer.java"},{"diff":"@@ -5,7 +5,7 @@\n     <container qualifier=\"tomcat\" default=\"true\">\n         <configuration>\n             <property name=\"catalinaHome\">${CATALINA_HOME:target/apache-tomcat-7.0.20}</property>\n-            <property name=\"javaVmArguments\">-Xmx1024m -XX:MaxPermSize=512m</property>\n+            <property name=\"javaVmArguments\">-Xmx1024m  -XX:MaxPermSize=512m</property>\n             <property name=\"jmxPort\">8089</property>\n             <property name=\"bindHttpPort\">8080</property>\n             <!-- [ARQ-630]. We'll use credentials with ISO-8859-1 characters for testing. ","filename":"tomcat-managed-7/src/test/resources/arquillian.xml"}],"id":"710b42bb548ec3f824dc599a8811b7261c571dab"}}