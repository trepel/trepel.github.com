{"commit":{"id":"c1238960e0b26239c87550a22a77bc4f9b5a3ff2","url":"/jbossas/jboss-as/commit/c1238960e0b26239c87550a22a77bc4f9b5a3ff2","author":{"name":"jaikiran","email":"jaikiran.pai@gmail.com","login":"jaikiran"},"authored_date":"2011-06-15T21:31:11-07:00","tree":"8ebb8806aed30ed2cb324143dbc0c0e74b899a41","parents":[{"id":"b604ab72715cc9c4bd7f221a19dd4f5ca728479b"}],"message":"AS7-1022 Use a different ShrinkWrap API to workaround build failures on Windows OS caused by SHRINKWRAP-286","modified":[{"filename":"arquillian/protocol-jmx/src/main/java/org/jboss/as/arquillian/protocol/jmx/JMXProtocolPackager.java","diff":"@@ -26,6 +26,7 @@\n import java.io.InputStreamReader;\n import java.io.OutputStreamWriter;\n import java.io.PrintWriter;\n+import java.net.URL;\n import java.util.Collection;\n import java.util.HashSet;\n import java.util.Set;\n@@ -48,6 +49,7 @@\n import org.jboss.shrinkwrap.api.ShrinkWrap;\n import org.jboss.shrinkwrap.api.asset.Asset;\n import org.jboss.shrinkwrap.api.asset.StringAsset;\n+import org.jboss.shrinkwrap.api.asset.UrlAsset;\n import org.jboss.shrinkwrap.api.spec.JavaArchive;\n \n /**\n@@ -133,7 +135,11 @@ public InputStream openStream() {\n \n         // Add the ServiceActivator\n         String serviceActivatorPath = \"META-INF/services/\" + ServiceActivator.class.getName();\n-        archive.addAsResource(\"arquillian-service/\" + serviceActivatorPath, serviceActivatorPath);\n+        final URL serviceActivatorURL = this.getClass().getClassLoader().getResource(\"arquillian-service/\" + serviceActivatorPath);\n+        if (serviceActivatorURL == null) {\n+            throw new RuntimeException(\"No arquillian-service/\" + serviceActivatorPath + \" found by classloader: \" + this.getClass().getClassLoader());\n+        }\n+        archive.addAsResource(new UrlAsset(serviceActivatorURL), serviceActivatorPath);\n \n         // Add META-INF/jbosgi-xservice.properties which registers the arquillian service with the OSGi layer\n         // Generated default imports for OSGi tests are defined in {@link AbstractOSGiApplicationArchiveProcessor}"}],"committed_date":"2011-06-16T04:25:43-07:00","committer":{"name":"kabir","email":"kkhan@redhat.com","login":"kabir"}}}