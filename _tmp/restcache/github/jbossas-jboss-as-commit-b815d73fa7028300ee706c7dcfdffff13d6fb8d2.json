{"commit":{"tree":"964df1a15e36610f56e410ab6e1d6ca2eb6353a8","committed_date":"2011-06-18T17:56:12-07:00","authored_date":"2011-05-09T08:03:31-07:00","committer":{"login":"bstansberry","email":"brian.stansberry@redhat.com","name":"bstansberry@jboss.com"},"url":"/jbossas/jboss-as/commit/b815d73fa7028300ee706c7dcfdffff13d6fb8d2","added":["arquillian/container-managed-clustering/pom.xml","arquillian/container-managed-clustering/src/main/java/org/jboss/as/arquillian/container/managed/clustering/ManagedContainerConfiguration.java","arquillian/container-managed-clustering/src/main/java/org/jboss/as/arquillian/container/managed/clustering/ManagedContainerExtension.java","arquillian/container-managed-clustering/src/main/java/org/jboss/as/arquillian/container/managed/clustering/ManagedDeployableContainer.java","arquillian/container-managed-clustering/src/main/resources/META-INF/services/org.jboss.arquillian.core.spi.LoadableExtension","build/src/main/resources/modules/org/jboss/as/clustering/api/main/module.xml","build/src/main/resources/modules/org/jboss/as/clustering/common/main/module.xml","build/src/main/resources/modules/org/jboss/as/clustering/impl/main/module.xml","build/src/main/resources/modules/org/jboss/as/clustering/infinispan/main/module.xml","build/src/main/resources/modules/org/jboss/as/clustering/jgroups/main/module.xml","build/src/main/resources/modules/org/jboss/as/clustering/web/infinispan/main/module.xml","build/src/main/resources/modules/org/jboss/as/clustering/web/spi/main/module.xml","clustering/api/pom.xml","clustering/api/src/main/java/org/jboss/as/clustering/ClusterNode.java","clustering/api/src/main/java/org/jboss/as/clustering/GroupCommunicationService.java","clustering/api/src/main/java/org/jboss/as/clustering/GroupMembershipListener.java","clustering/api/src/main/java/org/jboss/as/clustering/GroupMembershipNotifier.java","clustering/api/src/main/java/org/jboss/as/clustering/GroupRpcDispatcher.java","clustering/api/src/main/java/org/jboss/as/clustering/GroupStateTransferService.java","clustering/api/src/main/java/org/jboss/as/clustering/HashableMarshalledValue.java","clustering/api/src/main/java/org/jboss/as/clustering/HashableMarshalledValueFactory.java","clustering/api/src/main/java/org/jboss/as/clustering/MarshalledValue.java","clustering/api/src/main/java/org/jboss/as/clustering/MarshalledValueFactory.java","clustering/api/src/main/java/org/jboss/as/clustering/MarshallingContext.java","clustering/api/src/main/java/org/jboss/as/clustering/ResponseFilter.java","clustering/api/src/main/java/org/jboss/as/clustering/SerializableStateTransferResult.java","clustering/api/src/main/java/org/jboss/as/clustering/SimpleMarshalledValue.java","clustering/api/src/main/java/org/jboss/as/clustering/SimpleMarshalledValueFactory.java","clustering/api/src/main/java/org/jboss/as/clustering/StateTransferProvider.java","clustering/api/src/main/java/org/jboss/as/clustering/StateTransferResult.java","clustering/api/src/main/java/org/jboss/as/clustering/StateTransferStreamProvider.java","clustering/api/src/main/java/org/jboss/as/clustering/StreamStateTransferResult.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/AbstractClusterLockSupport.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/ClusterLockState.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/LocalAndClusterLockManager.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/LocalLockHandler.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/NonGloballyExclusiveClusterLockSupport.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/RemoteLockResponse.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/SharedLocalYieldingClusterLockManager.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/TimeoutException.java","clustering/api/src/main/java/org/jboss/as/clustering/lock/YieldingGloballyExclusiveClusterLockSupport.java","clustering/api/src/test/java/org/jboss/as/clustering/HashableMarshalledValueFactoryTestCase.java","clustering/api/src/test/java/org/jboss/as/clustering/MockClusterNode.java","clustering/api/src/test/java/org/jboss/as/clustering/SimpleMarshalledValueFactoryTestCase.java","clustering/api/src/test/java/org/jboss/as/clustering/lock/ClusteredLockManagerTestBase.java","clustering/api/src/test/java/org/jboss/as/clustering/lock/LockParamsMatcher.java","clustering/api/src/test/java/org/jboss/as/clustering/lock/ReadWriteClusteredLockManagerUnitTestCase.java","clustering/api/src/test/java/org/jboss/as/clustering/lock/SharedLocalYieldingClusterLockManagerUnitTestCase.java","clustering/api/src/test/java/org/jboss/as/clustering/lock/YieldingGloballyExclusiveClusterLockSupportUnitTestCase.java","clustering/common/pom.xml","clustering/common/src/main/java/org/jboss/as/clustering/ManagedExecutorService.java","clustering/common/src/main/java/org/jboss/as/clustering/ManagedScheduledExecutorService.java","clustering/common/src/test/java/org/jboss/as/clustering/ManagedExecutorServiceTest.java","clustering/common/src/test/java/org/jboss/as/clustering/ManagedScheduledExecutorTest.java","clustering/common/src/test/java/org/jboss/staxmapper/XMLExtendedStreamWriterFactory.java","clustering/impl/pom.xml","clustering/impl/src/main/java/org/jboss/as/clustering/AsynchEventHandler.java","clustering/impl/src/main/java/org/jboss/as/clustering/ClusterNodeFactory.java","clustering/impl/src/main/java/org/jboss/as/clustering/ClusterNodeImpl.java","clustering/impl/src/main/java/org/jboss/as/clustering/CoreGroupCommunicationService.java","clustering/impl/src/main/java/org/jboss/as/clustering/RspFilterAdapter.java","clustering/infinispan/pom.xml","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/ChannelProvider.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/DefaultEmbeddedCacheManager.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/ExecutorProvider.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/MBeanServerProvider.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/TransactionManagerProvider.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/TransactionSynchronizationRegistryProvider.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/atomic/AtomicMapCache.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/invoker/CacheInvoker.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/invoker/RetryingCacheInvoker.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Attribute.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/CacheContainerAdd.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/CacheContainerRemove.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/CacheService.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EagerLocking.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Element.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EmbeddedCacheManagerConfiguration.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EmbeddedCacheManagerDefaults.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EmbeddedCacheManagerDefaultsService.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EmbeddedCacheManagerService.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/FileCacheStoreConfig.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Indexing.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/InfinispanExtension.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/InfinispanSubsystemAdd.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/InfinispanSubsystemDescribe.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/LocalDescriptions.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Mode.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/ModelKeys.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Namespace.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/StartMode.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/TransactionMode.java","clustering/infinispan/src/main/java/org/jboss/as/clustering/infinispan/subsystem/TransportConfiguration.java","clustering/infinispan/src/main/resources/META-INF/services/org.jboss.as.controller.Extension","clustering/infinispan/src/main/resources/infinispan-defaults.xml","clustering/infinispan/src/main/resources/org/jboss/as/clustering/infinispan/subsystem/LocalDescriptions.properties","clustering/infinispan/src/main/resources/schema/jboss-infinispan.xsd","clustering/infinispan/src/test/java/org/jboss/as/clustering/infinispan/DefaultEmbeddedCacheManagerTest.java","clustering/infinispan/src/test/java/org/jboss/as/clustering/infinispan/subsystem/InfinispanSubsystemParserTest.java","clustering/infinispan/src/test/java/org/jboss/as/clustering/infinispan/subsystem/SchemaValidationTest.java","clustering/infinispan/src/test/resources/subsystem-infinispan.xml","clustering/jgroups/pom.xml","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/ChannelFactory.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/JChannelFactory.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/ManagedSocketFactory.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/ProtocolConfiguration.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/ProtocolDefaults.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/ProtocolStackConfiguration.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/ThreadFactoryAdapter.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/TimerSchedulerAdapter.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/TransportConfiguration.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/mux/DelegatingStateTransferUpHandler.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/mux/MuxUpHandler.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/mux/StateTransferFilter.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/Attribute.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ChannelFactoryService.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/Element.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/JGroupsExtension.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/JGroupsSubsystemAdd.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/JGroupsSubsystemDescribe.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/LocalDescriptions.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ModelKeys.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/Namespace.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ProtocolDefaultsService.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ProtocolStackAdd.java","clustering/jgroups/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ProtocolStackRemove.java","clustering/jgroups/src/main/resources/META-INF/services/org.jboss.as.controller.Extension","clustering/jgroups/src/main/resources/jgroups-defaults.xml","clustering/jgroups/src/main/resources/org/jboss/as/clustering/jgroups/subsystem/LocalDescriptions.properties","clustering/jgroups/src/main/resources/schema/jboss-infinispan.xsd","clustering/jgroups/src/main/resources/schema/jboss-jgroups.xsd","clustering/jgroups/src/test/java/org/jboss/as/clustering/ManagedExecutorServiceTest.java","clustering/jgroups/src/test/java/org/jboss/as/clustering/ManagedScheduledExecutorTest.java","clustering/jgroups/src/test/java/org/jboss/as/clustering/jgroups/ManagedSocketFactoryTest.java","clustering/jgroups/src/test/java/org/jboss/as/clustering/jgroups/subsystem/JGroupsSubsystemParserTest.java","clustering/jgroups/src/test/java/org/jboss/as/clustering/jgroups/subsystem/SchemaValidationTest.java","clustering/jgroups/src/test/java/org/jboss/staxmapper/XMLExtendedStreamWriterFactory.java","clustering/jgroups/src/test/resources/subsystem-infinispan.xml","clustering/jgroups/src/test/resources/subsystem-jgroups.xml","clustering/web-infinispan/pom.xml","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/CacheSource.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/CoarseSessionAttributeStorage.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/DefaultLockManagerSource.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/DistributedCacheManager.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/DistributedCacheManagerFactory.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/FineSessionAttributeStorage.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/JvmRouteCacheSource.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/LockManagerSource.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/ServiceNameProvider.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/SessionAttributeStorage.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/SessionAttributeStorageFactory.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/SessionAttributeStorageFactoryImpl.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/SessionCacheSource.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/SessionKey.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/SessionKeyFactory.java","clustering/web-infinispan/src/main/java/org/jboss/as/clustering/web/infinispan/SessionMapEntry.java","clustering/web-infinispan/src/main/resources/META-INF/services/org.jboss.as.clustering.web.DistributedCacheManagerFactory","clustering/web-infinispan/src/test/java/org/jboss/as/clustering/web/infinispan/CoarseSessionAttributeStorageTest.java","clustering/web-infinispan/src/test/java/org/jboss/as/clustering/web/infinispan/DistributedCacheManagerFactoryTest.java","clustering/web-infinispan/src/test/java/org/jboss/as/clustering/web/infinispan/DistributedCacheManagerTest.java","clustering/web-infinispan/src/test/java/org/jboss/as/clustering/web/infinispan/FineSessionAttributeStorageTest.java","clustering/web-infinispan/src/test/java/org/jboss/as/clustering/web/infinispan/JvmRouteCacheSourceTest.java","clustering/web-infinispan/src/test/java/org/jboss/as/clustering/web/infinispan/SessionAttributeStorageFactoryTest.java","clustering/web-infinispan/src/test/java/org/jboss/as/clustering/web/infinispan/SessionCacheSourceTest.java","clustering/web-infinispan/src/test/java/org/jboss/as/clustering/web/infinispan/SessionMapEntryTest.java","clustering/web-spi/pom.xml","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/BatchingManager.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/ClusteringNotSupportedException.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/DistributableSessionMetadata.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/DistributedCacheManager.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/DistributedCacheManagerFactory.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/IncomingDistributableSessionData.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/LocalDistributableSessionManager.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/OutgoingAttributeGranularitySessionData.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/OutgoingDistributableSessionData.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/OutgoingSessionGranularitySessionData.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/SessionAttributeMarshaller.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/SessionAttributeMarshallerFactory.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/SessionOwnershipSupport.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/impl/IncomingDistributableSessionDataImpl.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/impl/SessionAttributeMarshallerFactoryImpl.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/impl/SessionAttributeMarshallerImpl.java","clustering/web-spi/src/main/java/org/jboss/as/clustering/web/impl/TransactionBatchingManager.java","clustering/web-spi/src/test/java/org/jboss/as/clustering/web/impl/SessionAttributeMarshallerFactoryTest.java","clustering/web-spi/src/test/java/org/jboss/as/clustering/web/impl/SessionAttributeMarshallerTest.java","clustering/web-spi/src/test/java/org/jboss/as/clustering/web/impl/TransactionBatchingManagerTest.java","testsuite/clustering/pom.xml","testsuite/clustering/src/test/java/org/jboss/as/testsuite/clustering/web/SimpleServlet.java","testsuite/clustering/src/test/java/org/jboss/as/testsuite/clustering/web/SimpleWebTestCase.java","testsuite/clustering/src/test/resources/arquillian.xml","testsuite/clustering/src/test/resources/distributable.war/WEB-INF/web.xml","testsuite/clustering/src/test/resources/logging.properties","web/src/main/java/org/jboss/as/web/session/AbstractSessionManager.java","web/src/main/java/org/jboss/as/web/session/AskSessionOutdatedSessionChecker.java","web/src/main/java/org/jboss/as/web/session/AttributeBasedClusteredSession.java","web/src/main/java/org/jboss/as/web/session/ClusteredSession.java","web/src/main/java/org/jboss/as/web/session/ClusteredSessionManager.java","web/src/main/java/org/jboss/as/web/session/ClusteredSessionValve.java","web/src/main/java/org/jboss/as/web/session/DistributableSessionManager.java","web/src/main/java/org/jboss/as/web/session/DistributableSessionManagerMBean.java","web/src/main/java/org/jboss/as/web/session/InstantSnapshotManager.java","web/src/main/java/org/jboss/as/web/session/IntervalSnapshotManager.java","web/src/main/java/org/jboss/as/web/session/JvmRouteValve.java","web/src/main/java/org/jboss/as/web/session/LockingValve.java","web/src/main/java/org/jboss/as/web/session/NonSerializableAttributeTester.java","web/src/main/java/org/jboss/as/web/session/OutdatedSessionChecker.java","web/src/main/java/org/jboss/as/web/session/OutgoingDistributableSessionDataImpl.java","web/src/main/java/org/jboss/as/web/session/OwnedSessionUpdate.java","web/src/main/java/org/jboss/as/web/session/ReplicationStatistics.java","web/src/main/java/org/jboss/as/web/session/SessionBasedClusteredSession.java","web/src/main/java/org/jboss/as/web/session/SessionInvalidationTracker.java","web/src/main/java/org/jboss/as/web/session/SessionManager.java","web/src/main/java/org/jboss/as/web/session/SessionManagerMBean.java","web/src/main/java/org/jboss/as/web/session/SessionReplicationContext.java","web/src/main/java/org/jboss/as/web/session/SnapshotManager.java","web/src/main/java/org/jboss/as/web/session/notification/ClusteredSessionManagementStatus.java","web/src/main/java/org/jboss/as/web/session/notification/ClusteredSessionNotificationCapability.java","web/src/main/java/org/jboss/as/web/session/notification/ClusteredSessionNotificationCause.java","web/src/main/java/org/jboss/as/web/session/notification/ClusteredSessionNotificationPolicy.java","web/src/main/java/org/jboss/as/web/session/notification/ClusteredSessionNotificationPolicyBase.java","web/src/main/java/org/jboss/as/web/session/notification/IgnoreUndeployLegacyClusteredSessionNotificationPolicy.java","web/src/main/java/org/jboss/as/web/session/notification/LegacyClusteredSessionNotificationPolicy.java","web/src/test/java/org/jboss/as/web/session/AttributeBasedMaxUnreplicatedIntervalTestCase.java","web/src/test/java/org/jboss/as/web/session/ClusteredSessionMemoryLeakTestCase.java","web/src/test/java/org/jboss/as/web/session/ClusteredSessionNotificationPolicyTestCase.java","web/src/test/java/org/jboss/as/web/session/ClusteredSessionUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/ConcurrentFailoverRequestsTestCase.java","web/src/test/java/org/jboss/as/web/session/DistributableSessionManagerConfigurationUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/DistributionFailoverUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/DistributionToPassivatedSessionUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/FailedExpirationTestCase.java","web/src/test/java/org/jboss/as/web/session/InfinispanCacheContainerTest.java","web/src/test/java/org/jboss/as/web/session/JGroupsSystemPropertySupport.java","web/src/test/java/org/jboss/as/web/session/JvmRouteValveUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/MultipleWarSingleRedeployTestCase.java","web/src/test/java/org/jboss/as/web/session/ReplicationToPassivatedSessionUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/SessionBasedMaxUnreplicatedIntervalTestCase.java","web/src/test/java/org/jboss/as/web/session/SessionCountUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/SessionExpirationUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/SessionSpecListenerAttribute.java","web/src/test/java/org/jboss/as/web/session/SessionTestUtil.java","web/src/test/java/org/jboss/as/web/session/SetNewSessionCookieUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/StoppedManagerUnitTestCase.java","web/src/test/java/org/jboss/as/web/session/mocks/BasicRequestHandler.java","web/src/test/java/org/jboss/as/web/session/mocks/ConcurrentRequestHandler.java","web/src/test/java/org/jboss/as/web/session/mocks/InvalidateSessionRequestHandler.java","web/src/test/java/org/jboss/as/web/session/mocks/MockClusteredSessionManager.java","web/src/test/java/org/jboss/as/web/session/mocks/MockClusteredSessionNotificationPolicy.java","web/src/test/java/org/jboss/as/web/session/mocks/MockContainer.java","web/src/test/java/org/jboss/as/web/session/mocks/MockDistributedCacheManager.java","web/src/test/java/org/jboss/as/web/session/mocks/MockDistributedCacheManagerFactory.java","web/src/test/java/org/jboss/as/web/session/mocks/MockEngine.java","web/src/test/java/org/jboss/as/web/session/mocks/MockHost.java","web/src/test/java/org/jboss/as/web/session/mocks/MockHttpSessionAttributeListener.java","web/src/test/java/org/jboss/as/web/session/mocks/MockHttpSessionListener.java","web/src/test/java/org/jboss/as/web/session/mocks/MockLoader.java","web/src/test/java/org/jboss/as/web/session/mocks/MockRequest.java","web/src/test/java/org/jboss/as/web/session/mocks/MockResponse.java","web/src/test/java/org/jboss/as/web/session/mocks/MockSession.java","web/src/test/java/org/jboss/as/web/session/mocks/MockSessionManager.java","web/src/test/java/org/jboss/as/web/session/mocks/MockValve.java","web/src/test/java/org/jboss/as/web/session/mocks/MutableObject.java","web/src/test/java/org/jboss/as/web/session/mocks/RemoveAttributesRequestHandler.java","web/src/test/java/org/jboss/as/web/session/mocks/RequestHandler.java","web/src/test/java/org/jboss/as/web/session/mocks/RequestHandlerValve.java","web/src/test/java/org/jboss/as/web/session/mocks/SetAttributesRequestHandler.java","web/src/test/resources/jgroups-udp.xml"],"parents":[{"id":"41ec5354c66de9935d8cce58a0a1e34791bf47c8"}],"removed":["build/src/main/resources/modules/org/jboss/as/clustering/main/module.xml","clustering/src/main/java/org/jboss/as/clustering/ManagedExecutorService.java","clustering/src/main/java/org/jboss/as/clustering/ManagedScheduledExecutorService.java","clustering/src/test/java/org/jboss/as/clustering/ManagedExecutorServiceTest.java","clustering/src/test/java/org/jboss/as/clustering/ManagedScheduledExecutorTest.java","clustering/src/test/java/org/jboss/staxmapper/XMLExtendedStreamWriterFactory.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/ChannelProvider.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/DefaultEmbeddedCacheManager.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/ExecutorProvider.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/MBeanServerProvider.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/TransactionManagerProvider.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/TransactionSynchronizationRegistryProvider.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Attribute.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/CacheContainerAdd.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/CacheContainerRemove.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/CacheService.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EagerLocking.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Element.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EmbeddedCacheManagerConfiguration.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EmbeddedCacheManagerDefaults.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EmbeddedCacheManagerDefaultsService.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/EmbeddedCacheManagerService.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/FileCacheStoreConfig.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Indexing.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/InfinispanExtension.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/InfinispanSubsystemAdd.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/InfinispanSubsystemDescribe.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/LocalDescriptions.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Mode.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/ModelKeys.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/Namespace.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/StartMode.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/TransactionMode.java","clustering/src/main/java/org/jboss/as/clustering/infinispan/subsystem/TransportConfiguration.java","clustering/src/main/resources/META-INF/services/org.jboss.as.controller.Extension","clustering/src/main/resources/infinispan-defaults.xml","clustering/src/main/resources/org/jboss/as/clustering/infinispan/subsystem/LocalDescriptions.properties","clustering/src/main/resources/schema/jboss-infinispan.xsd","clustering/src/test/java/org/jboss/as/clustering/infinispan/DefaultEmbeddedCacheManagerTest.java","clustering/src/test/java/org/jboss/as/clustering/infinispan/subsystem/InfinispanSubsystemParserTest.java","clustering/src/test/java/org/jboss/as/clustering/infinispan/subsystem/SchemaValidationTest.java","clustering/src/test/resources/subsystem-infinispan.xml","clustering/src/main/java/org/jboss/as/clustering/jgroups/ChannelFactory.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/JChannelFactory.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/ManagedSocketFactory.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/ProtocolConfiguration.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/ProtocolDefaults.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/ProtocolStackConfiguration.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/ThreadFactoryAdapter.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/TimerSchedulerAdapter.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/TransportConfiguration.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/Attribute.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ChannelFactoryService.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/Element.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/JGroupsExtension.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/JGroupsSubsystemAdd.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/JGroupsSubsystemDescribe.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/LocalDescriptions.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ModelKeys.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/Namespace.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ProtocolDefaultsService.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ProtocolStackAdd.java","clustering/src/main/java/org/jboss/as/clustering/jgroups/subsystem/ProtocolStackRemove.java","clustering/src/main/resources/jgroups-defaults.xml","clustering/src/main/resources/org/jboss/as/clustering/jgroups/subsystem/LocalDescriptions.properties","clustering/src/main/resources/schema/jboss-jgroups.xsd","clustering/src/test/java/org/jboss/as/clustering/jgroups/ManagedSocketFactoryTest.java","clustering/src/test/java/org/jboss/as/clustering/jgroups/subsystem/JGroupsSubsystemParserTest.java","clustering/src/test/java/org/jboss/as/clustering/jgroups/subsystem/SchemaValidationTest.java","clustering/src/test/resources/subsystem-jgroups.xml"],"message":"Distributed web session support","author":{"login":"pferraro","email":"paul.ferraro@redhat.com","name":"Paul Ferraro"},"modified":[{"diff":"@@ -32,9 +32,7 @@\n         <version>7.0.0.Beta4-SNAPSHOT</version>\n     </parent>\n \n-    <groupId>org.jboss.as</groupId>\n     <artifactId>jboss-as-arquillian</artifactId>\n-    <version>7.0.0.Beta4-SNAPSHOT</version>\n \n     <name>JBoss Application Server: Arquillian</name>\n \n@@ -44,6 +42,7 @@\n         <module>protocol-jmx</module>\n         <module>testenricher-msc</module>\n         <module>container-managed-domain</module>\n+        <module>container-managed-clustering</module>\n         <!--\n         <module>container-embedded</module>\n         <module>container-remote</module>","filename":"arquillian/pom.xml"},{"diff":"@@ -4,7 +4,7 @@\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee\n    http://java.sun.com/xml/ns/javaee/web-fragment_3_0.xsd\">\n-\n+   <distributable/>\n    <servlet>\n        <servlet-name>ServletTestRunner</servlet-name>\n        <servlet-class>org.jboss.as.arquillian.protocol.servlet.ServletTestRunner</servlet-class>","filename":"arquillian/protocol-servlet/src/main/resources/org/jboss/as/arquillian/protocol/servlet/web-fragment.xml"},{"diff":"@@ -415,8 +415,32 @@\n             <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-cli\"/>\n         </module-def>\n \n-        <module-def name=\"org.jboss.as.clustering\">\n-            <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-clustering\"/>\n+        <module-def name=\"org.jboss.as.clustering.api\">\n+            <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-clustering-api\"/>\n+        </module-def>\n+\n+        <module-def name=\"org.jboss.as.clustering.common\">\n+            <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-clustering-common\"/>\n+        </module-def>\n+\n+        <module-def name=\"org.jboss.as.clustering.impl\">\n+            <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-clustering-impl\"/>\n+        </module-def>\n+\n+        <module-def name=\"org.jboss.as.clustering.infinispan\">\n+            <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-clustering-infinispan\"/>\n+        </module-def>\n+\n+        <module-def name=\"org.jboss.as.clustering.jgroups\">\n+            <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-clustering-jgroups\"/>\n+        </module-def>\n+\n+        <module-def name=\"org.jboss.as.clustering.web.infinispan\">\n+            <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-clustering-web-infinispan\"/>\n+        </module-def>\n+\n+        <module-def name=\"org.jboss.as.clustering.web.spi\">\n+            <maven-resource group=\"org.jboss.as\" artifact=\"jboss-as-clustering-web-spi\"/>\n         </module-def>\n \n         <module-def name=\"org.jboss.as.connector\">","filename":"build/build.xml"},{"diff":"@@ -33,9 +33,7 @@\n         <version>7.0.0.Beta4-SNAPSHOT</version>\n     </parent>\n \n-    <groupId>org.jboss.as</groupId>\n     <artifactId>jboss-as-build</artifactId>\n-    <version>7.0.0.Beta4-SNAPSHOT</version>\n \n     <name>JBoss Application Server: Build</name>\n     <packaging>pom</packaging>\n@@ -590,8 +588,32 @@\n         </dependency>\n \n         <dependency>\n-            <groupId>org.jboss.as</groupId>\n-            <artifactId>jboss-as-clustering</artifactId>\n+           <groupId>org.jboss.as</groupId>\n+           <artifactId>jboss-as-clustering-api</artifactId>\n+        </dependency>\n+        <dependency>\n+           <groupId>org.jboss.as</groupId>\n+           <artifactId>jboss-as-clustering-common</artifactId>\n+        </dependency>\n+        <dependency>\n+           <groupId>org.jboss.as</groupId>\n+           <artifactId>jboss-as-clustering-impl</artifactId>\n+        </dependency>\n+        <dependency>\n+           <groupId>org.jboss.as</groupId>\n+           <artifactId>jboss-as-clustering-infinispan</artifactId>\n+        </dependency>\n+        <dependency>\n+           <groupId>org.jboss.as</groupId>\n+           <artifactId>jboss-as-clustering-jgroups</artifactId>\n+        </dependency>\n+        <dependency>\n+           <groupId>org.jboss.as</groupId>\n+           <artifactId>jboss-as-clustering-web-infinispan</artifactId>\n+        </dependency>\n+        <dependency>\n+           <groupId>org.jboss.as</groupId>\n+           <artifactId>jboss-as-clustering-web-spi</artifactId>\n         </dependency>\n \n         <dependency>","filename":"build/pom.xml"},{"diff":"@@ -27,8 +27,10 @@\n                             urn:jboss:domain:datasources:1.0 jboss-datasources.xsd\n                             urn:jboss:domain:ejb3:1.0 jboss-ejb3.xsd\n                             urn:jboss:domain:ee:1.0 jboss-ee.xsd\n+                            urn:jboss:domain:infinispan:1.0 jboss-infinispan.xsd\n                             urn:jboss:domain:jacorb:1.0 jboss-jacorb.xsd\n                             urn:jboss:domain:jaxrs:1.0 jboss-jaxrs.xsd\n+                            urn:jboss:domain:jgroups:1.0 jboss-jgroups.xsd\n                             urn:jboss:domain:jmx:1.0 jboss-jmx.xsd\n                             urn:jboss:domain:jpa:1.0 jboss-jpa.xsd\n                             urn:jboss:domain:messaging:1.0 jboss-messaging.xsd\n@@ -45,6 +47,8 @@\n                             urn:jboss:domain:weld:1.0 jboss-weld.xsd\">\n \n     <extensions>\n+        <extension module=\"org.jboss.as.clustering.infinispan\"/>\n+        <extension module=\"org.jboss.as.clustering.jgroups\"/>\n         <extension module=\"org.jboss.as.connector\"/>\n         <extension module=\"org.jboss.as.jmx\"/>\n         <extension module=\"org.jboss.as.jpa\"/>\n@@ -200,7 +204,7 @@\n                 </datasources>\n             </subsystem>\n             <subsystem xmlns=\"urn:jboss:domain:resourceadapters:1.0\" />\n-           <subsystem xmlns=\"urn:jboss:domain:osgi:1.0\" activation=\"lazy\">\n+            <subsystem xmlns=\"urn:jboss:domain:osgi:1.0\" activation=\"lazy\">\n                 <configuration pid=\"org.apache.felix.webconsole.internal.servlet.OsgiManager\">\n                     <property name=\"manager.root\">jboss-osgi</property>\n                 </configuration>\n@@ -262,108 +266,189 @@\n                 </modules>\n             </subsystem>\n \n-        <subsystem xmlns=\"urn:jboss:domain:messaging:1.0\">\n-            <!-- Default journal file size is 10Mb, reduced here to 100k for faster first boot -->\n-            <journal-file-size>102400</journal-file-size>\n-            <journal-min-files>2</journal-min-files>\n-            <journal-type>NIO</journal-type>\n-            <!-- disable messaging persistence -->\n-            <persistence-enabled>false</persistence-enabled>\n+            <subsystem xmlns=\"urn:jboss:domain:messaging:1.0\">\n+                <!-- Default journal file size is 10Mb, reduced here to 100k for faster first boot -->\n+                <journal-file-size>102400</journal-file-size>\n+                <journal-min-files>2</journal-min-files>\n+                <journal-type>NIO</journal-type>\n+                <!-- disable messaging persistence -->\n+                <persistence-enabled>false</persistence-enabled>\n \n-            <connectors>\n-               <in-vm-connector name=\"in-vm\" server-id=\"0\" />\n-               <netty-connector name=\"netty\" socket-binding=\"messaging\" />\n-               <netty-connector name=\"netty-throughput\" socket-binding=\"messaging-throughput\">\n-                  <param key=\"batch-delay\" value=\"50\"/>\n-               </netty-connector>\n-            </connectors>\n+                <connectors>\n+                   <in-vm-connector name=\"in-vm\" server-id=\"0\" />\n+                   <netty-connector name=\"netty\" socket-binding=\"messaging\" />\n+                   <netty-connector name=\"netty-throughput\" socket-binding=\"messaging-throughput\">\n+                      <param key=\"batch-delay\" value=\"50\"/>\n+                   </netty-connector>\n+                </connectors>\n \n-            <acceptors>\n-               <in-vm-acceptor name=\"in-vm\" server-id=\"0\" />\n-               <netty-acceptor name=\"netty\" socket-binding=\"messaging\" />\n-               <netty-acceptor name=\"netty-throughput\" socket-binding=\"messaging-throughput\">\n-                  <param key=\"batch-delay\" value=\"50\"/>\n-                  <param key=\"direct-deliver\" value=\"false\"/>\n-               </netty-acceptor>\n-            </acceptors>\n+                <acceptors>\n+                   <in-vm-acceptor name=\"in-vm\" server-id=\"0\" />\n+                   <netty-acceptor name=\"netty\" socket-binding=\"messaging\" />\n+                   <netty-acceptor name=\"netty-throughput\" socket-binding=\"messaging-throughput\">\n+                      <param key=\"batch-delay\" value=\"50\"/>\n+                      <param key=\"direct-deliver\" value=\"false\"/>\n+                   </netty-acceptor>\n+                </acceptors>\n \n-            <security-settings>\n-               <security-setting match=\"#\">\n-                   <permission type=\"createNonDurableQueue\" roles=\"guest\"/>\n-                   <permission type=\"deleteNonDurableQueue\" roles=\"guest\"/>\n-                    <permission type=\"consume\" roles=\"guest\"/>\n-                    <permission type=\"send\" roles=\"guest\"/>\n-               </security-setting>\n-            </security-settings>\n+                <security-settings>\n+                   <security-setting match=\"#\">\n+                       <permission type=\"createNonDurableQueue\" roles=\"guest\"/>\n+                       <permission type=\"deleteNonDurableQueue\" roles=\"guest\"/>\n+                        <permission type=\"consume\" roles=\"guest\"/>\n+                        <permission type=\"send\" roles=\"guest\"/>\n+                   </security-setting>\n+                </security-settings>\n \n-            <address-settings>\n-               <!--default for catch all-->\n-               <address-setting match=\"#\">\n-                  <dead-letter-address>jms.queue.DLQ</dead-letter-address>\n-                  <expiry-address>jms.queue.ExpiryQueue</expiry-address>\n-                  <redelivery-delay>0</redelivery-delay>\n-                  <max-size-bytes>10485760</max-size-bytes>\n-                  <message-counter-history-day-limit>10</message-counter-history-day-limit>\n-                  <address-full-policy>BLOCK</address-full-policy>\n-               </address-setting>\n-            </address-settings>\n+                <address-settings>\n+                   <!--default for catch all-->\n+                   <address-setting match=\"#\">\n+                      <dead-letter-address>jms.queue.DLQ</dead-letter-address>\n+                      <expiry-address>jms.queue.ExpiryQueue</expiry-address>\n+                      <redelivery-delay>0</redelivery-delay>\n+                      <max-size-bytes>10485760</max-size-bytes>\n+                      <message-counter-history-day-limit>10</message-counter-history-day-limit>\n+                      <address-full-policy>BLOCK</address-full-policy>\n+                   </address-setting>\n+                </address-settings>\n \n-            <!--JMS Stuff-->\n-           <jms-connection-factories>\n-              <connection-factory name=\"InVmConnectionFactory\">\n-                 <connectors>\n-                    <connector-ref connector-name=\"in-vm\"/>\n-                 </connectors>\n-                 <entries>\n-                    <entry name=\"java:/ConnectionFactory\"/>\n-                 </entries>\n-              </connection-factory>\n-              <connection-factory name=\"RemoteConnectionFactory\">\n-                 <connectors>\n-                    <connector-ref connector-name=\"netty\"/>\n-                 </connectors>\n-                 <entries>\n-                    <entry name=\"RemoteConnectionFactory\"/>\n-                 </entries>\n-              </connection-factory>\n-              <pooled-connection-factory name=\"hornetq-ra\">\n-                 <transaction mode=\"xa\"/>\n-                 <connectors>\n-                    <connector-ref connector-name=\"in-vm\"/>\n-                 </connectors>\n-                 <entries>\n-                    <entry name=\"java:/JmsXA\"/>\n-                 </entries>\n-              </pooled-connection-factory>\n-           </jms-connection-factories>\n-\n-           <jms-destinations>\n-              <jms-queue name=\"testQueue\">\n-                 <entry name=\"queue/test\"/>\n-              </jms-queue>\n-              <jms-topic name=\"testTopic\">\n-                 <entry name=\"topic/test\"/>\n-              </jms-topic>\n-           </jms-destinations>\n-        </subsystem>\n+                <!--JMS Stuff-->\n+               <jms-connection-factories>\n+                  <connection-factory name=\"InVmConnectionFactory\">\n+                     <connectors>\n+                        <connector-ref connector-name=\"in-vm\"/>\n+                     </connectors>\n+                     <entries>\n+                        <entry name=\"java:/ConnectionFactory\"/>\n+                     </entries>\n+                  </connection-factory>\n+                  <connection-factory name=\"RemoteConnectionFactory\">\n+                     <connectors>\n+                        <connector-ref connector-name=\"netty\"/>\n+                     </connectors>\n+                     <entries>\n+                        <entry name=\"RemoteConnectionFactory\"/>\n+                     </entries>\n+                  </connection-factory>\n+                  <pooled-connection-factory name=\"hornetq-ra\">\n+                     <transaction mode=\"xa\"/>\n+                     <connectors>\n+                        <connector-ref connector-name=\"in-vm\"/>\n+                     </connectors>\n+                     <entries>\n+                        <entry name=\"java:/JmsXA\"/>\n+                     </entries>\n+                  </pooled-connection-factory>\n+               </jms-connection-factories>\n+    \n+               <jms-destinations>\n+                  <jms-queue name=\"testQueue\">\n+                     <entry name=\"queue/test\"/>\n+                  </jms-queue>\n+                  <jms-topic name=\"testTopic\">\n+                     <entry name=\"topic/test\"/>\n+                  </jms-topic>\n+               </jms-destinations>\n+            </subsystem>\n             <subsystem xmlns=\"urn:jboss:domain:jaxrs:1.0\"/>\n             <subsystem xmlns=\"urn:jboss:domain:web:1.0\">\n-               <connector name=\"http\" scheme=\"http\" protocol=\"HTTP/1.1\" socket-binding=\"http\"/>\n-               <virtual-server name=\"localhost\">\n-                  <alias name=\"example.com\" />\n-               </virtual-server>\n-             </subsystem>\n-           <subsystem xmlns=\"urn:jboss:domain:webservices:1.0\">\n-             <modify-wsdl-address>true</modify-wsdl-address>\n-             <wsdl-host>localhost</wsdl-host>\n-             <!--\n-             <wsdl-port>8080</wsdl-port>\n-             <wsdl-secure-port>8443</wsdl-secure-port>\n-             -->\n-          </subsystem>\n-          <subsystem xmlns=\"urn:jboss:domain:modcluster:1.0\">\n-             <mod-cluster-config advertise-socket=\"mod_cluster\" />\n-          </subsystem>\n+                <connector name=\"http\" scheme=\"http\" protocol=\"HTTP/1.1\" socket-binding=\"http\"/>\n+                <virtual-server name=\"localhost\">\n+                    <alias name=\"example.com\" />\n+                </virtual-server>\n+            </subsystem>\n+            <subsystem xmlns=\"urn:jboss:domain:webservices:1.0\">\n+                <modify-wsdl-address>true</modify-wsdl-address>\n+                <wsdl-host>localhost</wsdl-host>\n+                <!--\n+                <wsdl-port>8080</wsdl-port>\n+                <wsdl-secure-port>8443</wsdl-secure-port>\n+                -->\n+            </subsystem>\n+            <subsystem xmlns=\"urn:jboss:domain:modcluster:1.0\">\n+                <mod-cluster-config advertise-socket=\"mod_cluster\" />\n+            </subsystem>\n+            <subsystem xmlns=\"urn:jboss:domain:jgroups:1.0\" default-stack=\"udp\">\n+                <stack name=\"udp\">\n+                    <transport type=\"UDP\" socket-binding=\"jgroups-udp\" diagnostics-socket-binding=\"jgroups-diagnostics\"/>\n+                    <protocol type=\"PING\"/>\n+                    <protocol type=\"MERGE2\"/>\n+                    <protocol type=\"FD_SOCK\" socket-binding=\"jgroups-udp-fd\"/>\n+                    <protocol type=\"FD\"/>\n+                    <protocol type=\"VERIFY_SUSPECT\"/>\n+                    <protocol type=\"BARRIER\"/>\n+                    <protocol type=\"pbcast.NAKACK\"/>\n+                    <protocol type=\"UNICAST\"/>\n+                    <protocol type=\"pbcast.STABLE\"/>\n+                    <protocol type=\"VIEW_SYNC\"/>\n+                    <protocol type=\"pbcast.GMS\"/>\n+                    <protocol type=\"UFC\"/>\n+                    <protocol type=\"MFC\"/>\n+                    <protocol type=\"FRAG2\"/>\n+                    <protocol type=\"pbcast.STREAMING_STATE_TRANSFER\"/>\n+                    <protocol type=\"pbcast.FLUSH\"/>\n+                </stack>\n+                <stack name=\"tcp\">\n+                    <transport type=\"TCP\" socket-binding=\"jgroups-tcp\" diagnostics-socket-binding=\"jgroups-diagnostics\"/>\n+                    <protocol type=\"MPING\" socket-binding=\"jgroups-mping\"/>\n+                    <protocol type=\"MERGE2\"/>\n+                    <protocol type=\"FD_SOCK\" socket-binding=\"jgroups-tcp-fd\"/>\n+                    <protocol type=\"FD\"/>\n+                    <protocol type=\"VERIFY_SUSPECT\"/>\n+                    <protocol type=\"BARRIER\"/>\n+                    <protocol type=\"pbcast.NAKACK\"/>\n+                    <protocol type=\"UNICAST\"/>\n+                    <protocol type=\"pbcast.STABLE\"/>\n+                    <protocol type=\"VIEW_SYNC\"/>\n+                    <protocol type=\"pbcast.GMS\"/>\n+                    <protocol type=\"UFC\"/>\n+                    <protocol type=\"MFC\"/>\n+                    <protocol type=\"FRAG2\"/>\n+                    <protocol type=\"pbcast.STREAMING_STATE_TRANSFER\"/>\n+                    <protocol type=\"pbcast.FLUSH\"/>\n+                </stack>\n+            </subsystem>\n+            <subsystem xmlns=\"urn:jboss:domain:infinispan:1.0\" default-cache-container=\"cluster\">\n+                <cache-container name=\"cluster\" default-cache=\"default\">\n+                    <alias>ha-partition</alias>\n+                    <replicated-cache name=\"default\" mode=\"SYNC\" batching=\"true\">\n+                        <locking isolation=\"REPEATABLE_READ\"/>\n+                    </replicated-cache>\n+                </cache-container>\n+                <cache-container name=\"web\" default-cache=\"repl\">\n+                    <alias>standard-session-cache</alias>\n+                    <replicated-cache name=\"repl\" mode=\"ASYNC\" batching=\"true\">\n+                        <locking isolation=\"REPEATABLE_READ\"/>\n+                        <file-store/>\n+                    </replicated-cache>\n+                    <distributed-cache name=\"dist\" mode=\"ASYNC\" batching=\"true\">\n+                        <locking isolation=\"REPEATABLE_READ\"/>\n+                        <file-store/>\n+                    </distributed-cache>\n+                </cache-container>\n+                <cache-container name=\"sfsb\" default-cache=\"repl\">\n+                    <alias>sfsb-cache</alias>\n+                    <alias>jboss.cache:service=EJB3SFSBClusteredCache</alias>\n+                    <replicated-cache name=\"repl\" mode=\"ASYNC\" batching=\"true\">\n+                        <locking isolation=\"REPEATABLE_READ\"/>\n+                        <eviction strategy=\"LRU\" max-entries=\"10000\"/>\n+                        <file-store/>\n+                    </replicated-cache>\n+                </cache-container>\n+                <cache-container name=\"hibernate\" default-cache=\"local-query\">\n+                    <invalidation-cache name=\"entity\" mode=\"SYNC\">\n+                        <eviction strategy=\"LRU\" max-entries=\"10000\"/>\n+                        <expiration max-idle=\"100000\"/>\n+                    </invalidation-cache>\n+                    <local-cache name=\"local-query\">\n+                        <eviction strategy=\"LRU\" max-entries=\"10000\"/>\n+                        <expiration max-idle=\"100000\"/>\n+                    </local-cache>\n+                    <replicated-cache name=\"timestamps\" mode=\"ASYNC\">\n+                        <eviction strategy=\"NONE\"/>\n+                    </replicated-cache>\n+                </cache-container>\n+            </subsystem>\n         </profile>\n     </profiles>\n \n@@ -380,8 +465,9 @@\n     </interfaces>\n \n     <socket-binding-groups>\n-         <socket-binding-group name=\"standard-sockets\" default-interface=\"public\">\n+        <socket-binding-group name=\"standard-sockets\" default-interface=\"public\">\n             <include socket-binding-group=\"messaging-sockets\"/>\n+            <include socket-binding-group=\"clustering-sockets\"/>\n             <socket-binding name=\"jmx-connector-registry\" port=\"1090\"/>\n             <socket-binding name=\"jmx-connector-server\" port=\"1091\"/>\n             <socket-binding name=\"jndi\" port=\"1099\"/>\n@@ -393,11 +479,19 @@\n             <socket-binding name=\"remoting\" port=\"4447\"/>\n             <socket-binding name=\"txn-recovery-environment\" port=\"4712\"/>\n             <socket-binding name=\"txn-status-manager\" port=\"4713\"/>\n-         </socket-binding-group>\n-         <socket-binding-group name=\"messaging-sockets\" default-interface=\"public\">\n+        </socket-binding-group>\n+        <socket-binding-group name=\"messaging-sockets\" default-interface=\"public\">\n             <socket-binding name=\"messaging\" port=\"5445\" />\n             <socket-binding name=\"messaging-throughput\" port=\"5455\"/>\n-         </socket-binding-group>\n+        </socket-binding-group>\n+        <socket-binding-group name=\"clustering-sockets\" default-interface=\"public\">\n+            <socket-binding name=\"jgroups-udp\" port=\"55200\" multicast-address=\"230.0.0.4\" multicast-port=\"45688\"/>\n+            <socket-binding name=\"jgroups-udp-fd\" port=\"54200\"/>\n+            <socket-binding name=\"jgroups-diagnostics\" port=\"0\" multicast-address=\"224.0.75.75\" multicast-port=\"7500\"/>\n+            <socket-binding name=\"jgroups-tcp\" port=\"7600\"/>\n+            <socket-binding name=\"jgroups-tcp-fd\" port=\"57600\"/>\n+            <socket-binding name=\"jgroups-mping\" port=\"0\" multicast-address=\"230.0.0.4\" multicast-port=\"45700\"/>\n+        </socket-binding-group>\n     </socket-binding-groups>\n \n     <server-groups>","filename":"build/src/main/resources/domain/configuration/domain.xml"},{"diff":"@@ -33,7 +33,6 @@\n         <module name=\"org.jboss.logging\"/>\n         <module name=\"org.jboss.marshalling\"/>\n         <module name=\"org.jboss.marshalling.river\" services=\"import\"/>\n-        <module name=\"org.jgroups\"/>\n-        \n+        <module name=\"org.jgroups\" optional=\"true\"/>\n     </dependencies>\n </module>","filename":"build/src/main/resources/modules/org/infinispan/main/module.xml"},{"diff":"@@ -34,7 +34,7 @@\n         <module name=\"javax.security.jacc.api\"/>\n         <module name=\"javax.transaction.api\"/>\n         <module name=\"org.infinispan\"/>\n-        <module name=\"org.jboss.as.clustering\"/>\n+        <module name=\"org.jboss.as.clustering.infinispan\"/>\n         <module name=\"org.jboss.as.controller\"/>\n         <module name=\"org.jboss.as.server\"/>\n         <module name=\"org.jboss.as.naming\"/>","filename":"build/src/main/resources/modules/org/jboss/as/security/main/module.xml"},{"diff":"@@ -37,6 +37,7 @@\n         <module name=\"javax.servlet.jsp.api\"/>\n         <module name=\"org.jboss.jandex\"/>\n         <module name=\"org.jboss.staxmapper\"/>\n+        <module name=\"org.jboss.as.clustering.web.spi\" optional=\"true\"/>\n         <module name=\"org.jboss.as.controller\"/>\n         <module name=\"org.jboss.as.ee\"/>\n         <module name=\"org.jboss.as.naming\"/>","filename":"build/src/main/resources/modules/org/jboss/as/web/main/module.xml"},{"diff":"@@ -48,7 +48,8 @@\n                             urn:jboss:domain:weld:1.0 jboss-weld.xsd\">\n \n     <extensions>\n-        <extension module=\"org.jboss.as.clustering\"/>\n+        <extension module=\"org.jboss.as.clustering.infinispan\"/>\n+        <extension module=\"org.jboss.as.clustering.jgroups\"/>\n         <extension module=\"org.jboss.as.connector\"/>\n         <extension module=\"org.jboss.as.deployment-scanner\"/>\n         <extension module=\"org.jboss.as.ee\"/>\n@@ -58,6 +59,7 @@\n         <extension module=\"org.jboss.as.jpa\"/>\n         <extension module=\"org.jboss.as.logging\"/>\n         <extension module=\"org.jboss.as.messaging\"/>\n+        <extension module=\"org.jboss.as.modcluster\"/>\n         <extension module=\"org.jboss.as.naming\"/>\n         <extension module=\"org.jboss.as.osgi\"/>\n         <extension module=\"org.jboss.as.remoting\"/>\n@@ -73,6 +75,7 @@\n     <system-properties>\n         <property name=\"foo\" value=\"bar\"/>\n         <property name=\"key\" value=\"value\"/>\n+        <property name=\"java.net.preferIPv4Stack\" value=\"true\"/>\n     </system-properties>\n \n     <paths>\n@@ -81,8 +84,8 @@\n     </paths>\n \n     <management-interfaces>\n-       <native-interface interface=\"default\" port=\"9999\"/>\n-       <http-interface interface=\"default\" port=\"9990\"/>\n+       <native-interface interface=\"management\" port=\"9999\"/>\n+       <http-interface interface=\"management\" port=\"9990\"/>\n     </management-interfaces>\n \n     <profile>\n@@ -126,18 +129,6 @@\n                 <max-threads count=\"10\" per-cpu=\"20\"/>\n                 <keepalive-time time=\"10\" unit=\"seconds\"/>\n             </scheduled-thread-pool>\n-            <bounded-queue-thread-pool name=\"jca-short-running\" blocking=\"true\">\n-                <core-threads count=\"10\" per-cpu=\"20\"/>\n-                <queue-length count=\"10\" per-cpu=\"20\"/>\n-                <max-threads count=\"10\" per-cpu=\"20\"/>\n-                <keepalive-time time=\"10\" unit=\"seconds\"/>\n-            </bounded-queue-thread-pool>\n-            <bounded-queue-thread-pool name=\"jca-long-running\" blocking=\"true\">\n-                <core-threads count=\"10\" per-cpu=\"20\"/>\n-                <queue-length count=\"10\" per-cpu=\"20\"/>\n-                <max-threads count=\"10\" per-cpu=\"20\"/>\n-                <keepalive-time time=\"10\" unit=\"seconds\"/>\n-            </bounded-queue-thread-pool>\n             <bounded-queue-thread-pool name=\"ejb3-async\" blocking=\"true\">\n                 <core-threads count=\"10\" per-cpu=\"20\"/>\n                 <queue-length count=\"10\" per-cpu=\"20\"/>\n@@ -150,7 +141,7 @@\n         <subsystem xmlns=\"urn:jboss:domain:naming:1.0\" />\n         <subsystem xmlns=\"urn:jboss:domain:security:1.0\">\n             <security-domains>\n-                <security-domain name=\"other\">\n+                <security-domain name=\"other\" cache-type=\"default\">\n                     <authentication>\n                         <login-module code=\"UsersRoles\" flag=\"required\"/>\n                     </authentication>\n@@ -169,29 +160,27 @@\n         <subsystem xmlns=\"urn:jboss:domain:transactions:1.0\">\n             <recovery-environment socket-binding=\"txn-recovery-environment\" status-socket-binding=\"txn-status-manager\"/>\n             <core-environment>\n-                <process-id><uuid/></process-id>\n+                <process-id>\n+                    <uuid />\n+                </process-id>\n             </core-environment>\n         </subsystem>\n         <subsystem xmlns=\"urn:jboss:domain:jca:1.0\">\n             <archive-validation enabled=\"false\" />\n             <bean-validation enabled=\"false\" />\n             <default-workmanager>\n-            \t<short-running-threads>\n-            \t\t<bounded-queue-thread-pool xmlns=\"urn:jboss:domain:threads:1.0\" name=\"jca-short-running\" blocking=\"true\">\n-                \t\t<core-threads count=\"10\" per-cpu=\"20\"/>\n-                \t\t<queue-length count=\"10\" per-cpu=\"20\"/>\n-                \t\t<max-threads count=\"10\" per-cpu=\"20\"/>\n-                \t\t<keepalive-time time=\"10\" unit=\"seconds\"/>\n-            \t\t</bounded-queue-thread-pool>\n-            \t</short-running-threads>\n-            \t<long-running-threads>\n-\t            \t<bounded-queue-thread-pool xmlns=\"urn:jboss:domain:threads:1.0\" name=\"jca-long-running\" blocking=\"true\">\n-\t\t                <core-threads count=\"10\" per-cpu=\"20\"/>\n-\t\t                <queue-length count=\"10\" per-cpu=\"20\"/>\n-\t\t                <max-threads count=\"10\" per-cpu=\"20\"/>\n-\t\t                <keepalive-time time=\"10\" unit=\"seconds\"/>\n-\t            \t</bounded-queue-thread-pool>\n-            \t</long-running-threads>\n+                <short-running-threads blocking=\"true\">\n+                <core-threads count=\"10\" per-cpu=\"20\"/>\n+                        <queue-length count=\"10\" per-cpu=\"20\"/>\n+                        <max-threads count=\"10\" per-cpu=\"20\"/>\n+                        <keepalive-time time=\"10\" unit=\"seconds\"/>\n+                </short-running-threads>\n+                <long-running-threads blocking=\"true\">\n+                        <core-threads count=\"10\" per-cpu=\"20\"/>\n+                        <queue-length count=\"10\" per-cpu=\"20\"/>\n+                        <max-threads count=\"10\" per-cpu=\"20\"/>\n+                        <keepalive-time time=\"10\" unit=\"seconds\"/>\n+                </long-running-threads>\n             </default-workmanager>\n         </subsystem>\n         <subsystem xmlns=\"urn:jboss:domain:datasources:1.0\">\n@@ -208,11 +197,11 @@\n                     <timeout></timeout>\n                     <statement></statement>\n                 </datasource>\n-\t            <drivers>\n-\t                <driver name=\"h2\" module=\"com.h2database.h2\">\n-\t                \t<xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>\n-\t                </driver>\n-\t            </drivers>\n+                <drivers>\n+                    <driver name=\"h2\" module=\"com.h2database.h2\">\n+                        <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>\n+                    </driver>\n+                </drivers>\n             </datasources>\n        </subsystem>\n        <subsystem xmlns=\"urn:jboss:domain:resourceadapters:1.0\" />\n@@ -363,7 +352,7 @@\n         </subsystem>\n         <subsystem xmlns=\"urn:jboss:domain:web:1.0\">\n             <connector name=\"http\" scheme=\"http\" protocol=\"HTTP/1.1\" socket-binding=\"http\"/>\n-            <virtual-server name=\"localhost\">\n+            <virtual-server name=\"localhost\" enable-welcome-root=\"true\">\n                <alias name=\"example.com\" />\n             </virtual-server>\n         </subsystem>\n@@ -379,6 +368,9 @@\n              <wsdl-secure-port>8443</wsdl-secure-port>\n              -->\n         </subsystem>\n+        <subsystem xmlns=\"urn:jboss:domain:modcluster:1.0\">\n+            <mod-cluster-config advertise-socket=\"mod_cluster\" />\n+        </subsystem>\n         <subsystem xmlns=\"urn:jboss:domain:jgroups:1.0\" default-stack=\"udp\">\n             <stack name=\"udp\">\n                 <transport type=\"UDP\" socket-binding=\"jgroups-udp\" diagnostics-socket-binding=\"jgroups-diagnostics\"/>\n@@ -426,17 +418,21 @@\n                     <locking isolation=\"REPEATABLE_READ\"/>\n                 </replicated-cache>\n             </cache-container>\n-            <cache-container name=\"web\" default-cache=\"repl-async\">\n+            <cache-container name=\"web\" default-cache=\"repl\">\n                 <alias>standard-session-cache</alias>\n-                <replicated-cache name=\"repl-async\" mode=\"ASYNC\" batching=\"true\">\n+                <replicated-cache name=\"repl\" mode=\"ASYNC\" batching=\"true\">\n                     <locking isolation=\"REPEATABLE_READ\"/>\n                     <file-store/>\n                 </replicated-cache>\n+                <distributed-cache name=\"dist\" mode=\"ASYNC\" batching=\"true\">\n+                    <locking isolation=\"REPEATABLE_READ\"/>\n+                    <file-store/>\n+                </distributed-cache>\n             </cache-container>\n-            <cache-container name=\"sfsb\" default-cache=\"repl-async\">\n+            <cache-container name=\"sfsb\" default-cache=\"repl\">\n                 <alias>sfsb-cache</alias>\n                 <alias>jboss.cache:service=EJB3SFSBClusteredCache</alias>\n-                <replicated-cache name=\"repl-async\" mode=\"ASYNC\" batching=\"true\">\n+                <replicated-cache name=\"repl\" mode=\"ASYNC\" batching=\"true\">\n                     <locking isolation=\"REPEATABLE_READ\"/>\n                     <eviction strategy=\"LRU\" max-entries=\"10000\"/>\n                     <file-store/>\n@@ -459,26 +455,15 @@\n     </profile>\n \n     <interfaces>\n-        <interface name=\"default\">\n+        <interface name=\"management\">\n             <inet-address value=\"127.0.0.1\"/>\n         </interface>\n-        <interface name=\"any\">\n-           <any-address/>\n-        </interface>\n-        <interface name=\"complex\">\n-           <any>\n-              <subnet-match value=\"192.168.0.0/16\"/>\n-              <public-address/>\n-           </any>\n-           <not>\n-             <site-local-address/>\n-           </not>\n-           <up/>\n-           <multicast/>\n+        <interface name=\"public\">\n+           <inet-address value=\"127.0.0.1\"/>\n         </interface>\n     </interfaces>\n \n-        <socket-binding-group name=\"standard-sockets\" default-interface=\"default\">\n+        <socket-binding-group name=\"standard-sockets\" default-interface=\"public\">\n            <socket-binding name=\"jndi\" port=\"1099\"/>\n            <socket-binding name=\"jmx-connector-registry\" port=\"1090\"/>\n            <socket-binding name=\"jmx-connector-server\" port=\"1091\"/>","filename":"build/src/main/resources/standalone/configuration/clustering-standalone.xml"},{"diff":"@@ -48,7 +48,7 @@\n                             urn:jboss:domain:weld:1.0 jboss-weld.xsd\">\n \n     <extensions>\n-        <extension module=\"org.jboss.as.clustering\"/>\n+        <extension module=\"org.jboss.as.clustering.infinispan\"/>\n         <extension module=\"org.jboss.as.connector\"/>\n         <extension module=\"org.jboss.as.deployment-scanner\"/>\n         <extension module=\"org.jboss.as.ee\"/>","filename":"build/src/main/resources/standalone/configuration/standalone.xml"},{"diff":"@@ -32,42 +32,23 @@\n         <version>7.0.0.Beta4-SNAPSHOT</version>\n     </parent>\n \n-    <groupId>org.jboss.as</groupId>\n     <artifactId>jboss-as-clustering</artifactId>\n+    <packaging>pom</packaging>\n \n     <name>JBoss Application Server: Clustering Subsystem</name>\n+    \n+    <modules>\n+        <module>api</module>\n+        <module>common</module>\n+        <module>impl</module>\n+        <module>infinispan</module>\n+        <module>jgroups</module>\n+        <module>web-infinispan</module>\n+        <module>web-spi</module>\n+    </modules>\n \n     <dependencies>\n         <dependency>\n-            <groupId>org.jboss.as</groupId>\n-            <artifactId>jboss-as-threads</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.jboss.as</groupId>\n-            <artifactId>jboss-as-ee</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.jboss.threads</groupId>\n-            <artifactId>jboss-threads</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.jgroups</groupId>\n-            <artifactId>jgroups</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.infinispan</groupId>\n-            <artifactId>infinispan-core</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.jboss.spec.javax.transaction</groupId>\n-            <artifactId>jboss-transaction-api_1.1_spec</artifactId>\n-        </dependency>\n-        <dependency>\n-            <groupId>org.jboss</groupId>\n-            <artifactId>jboss-common-core</artifactId>\n-        </dependency>\n-        \n-        <dependency>\n             <groupId>junit</groupId>\n             <artifactId>junit</artifactId>\n             <scope>test</scope>","filename":"clustering/pom.xml"},{"diff":"@@ -550,6 +550,12 @@\n \n             <dependency>\n                 <groupId>org.jboss.as</groupId>\n+                <artifactId>jboss-as-arquillian-container-managed-clustering</artifactId>\n+                <version>${project.version}</version>\n+            </dependency>\n+\n+            <dependency>\n+                <groupId>org.jboss.as</groupId>\n                 <artifactId>jboss-as-arquillian-container-managed-domain</artifactId>\n                 <version>${project.version}</version>\n             </dependency>\n@@ -599,6 +605,48 @@\n \n             <dependency>\n                 <groupId>org.jboss.as</groupId>\n+                <artifactId>jboss-as-clustering-api</artifactId>\n+                <version>${project.version}</version>\n+            </dependency>\n+\n+            <dependency>\n+                <groupId>org.jboss.as</groupId>\n+                <artifactId>jboss-as-clustering-common</artifactId>\n+                <version>${project.version}</version>\n+            </dependency>\n+\n+            <dependency>\n+                <groupId>org.jboss.as</groupId>\n+                <artifactId>jboss-as-clustering-impl</artifactId>\n+                <version>${project.version}</version>\n+            </dependency>\n+\n+            <dependency>\n+                <groupId>org.jboss.as</groupId>\n+                <artifactId>jboss-as-clustering-infinispan</artifactId>\n+                <version>${project.version}</version>\n+            </dependency>\n+\n+            <dependency>\n+                <groupId>org.jboss.as</groupId>\n+                <artifactId>jboss-as-clustering-jgroups</artifactId>\n+                <version>${project.version}</version>\n+            </dependency>\n+\n+            <dependency>\n+                <groupId>org.jboss.as</groupId>\n+                <artifactId>jboss-as-clustering-web-spi</artifactId>\n+                <version>${project.version}</version>\n+            </dependency>\n+\n+            <dependency>\n+                <groupId>org.jboss.as</groupId>\n+                <artifactId>jboss-as-clustering-web-infinispan</artifactId>\n+                <version>${project.version}</version>\n+            </dependency>\n+\n+            <dependency>\n+                <groupId>org.jboss.as</groupId>\n                 <artifactId>jboss-as-connector</artifactId>\n                 <version>${project.version}</version>\n             </dependency>","filename":"pom.xml"},{"diff":"@@ -78,7 +78,7 @@\n         \n         <dependency>\n             <groupId>org.jboss.as</groupId>\n-            <artifactId>jboss-as-clustering</artifactId>\n+            <artifactId>jboss-as-clustering-infinispan</artifactId>\n         </dependency>\n         \n         <dependency>","filename":"security/pom.xml"},{"diff":"@@ -186,6 +186,7 @@\n                 <module>spec</module>\n                 <module>integration</module>\n                 <module>domain</module>\n+                <module>clustering</module>\n             </modules>\n         </profile>\n ","filename":"testsuite/pom.xml"},{"diff":"@@ -32,28 +32,12 @@\n         <version>7.0.0.Beta4-SNAPSHOT</version>\n     </parent>\n \n-    <groupId>org.jboss.as</groupId>\n     <artifactId>jboss-as-web</artifactId>\n-    <version>7.0.0.Beta4-SNAPSHOT</version>\n+\n     <packaging>jar</packaging>\n \n     <name>JBoss Application Server: Web Subsystem</name>\n \n-    <build>\n-        <plugins>\n-            <plugin>\n-                <groupId>org.apache.maven.plugins</groupId>\n-                <artifactId>maven-surefire-plugin</artifactId>\n-                <configuration>\n-                    <includes>\n-                        <include>**/*TestCase.java</include>\n-                    </includes>\n-                    <enableAssertions>false</enableAssertions>\n-                </configuration>\n-            </plugin>\n-        </plugins>\n-    </build>\n-\n     <dependencies>\n         <dependency>\n             <groupId>org.jboss.spec.javax.faces</groupId>\n@@ -88,6 +72,11 @@\n \n         <dependency>\n             <groupId>org.jboss.as</groupId>\n+            <artifactId>jboss-as-clustering-web-spi</artifactId>\n+        </dependency>\n+\n+        <dependency>\n+            <groupId>org.jboss.as</groupId>\n             <artifactId>jboss-as-ee</artifactId>\n         </dependency>\n         \n@@ -130,6 +119,57 @@\n             <groupId>org.jboss.web</groupId>\n             <artifactId>jbossweb</artifactId>\n         </dependency>\n-\n+        \n+        <dependency>\n+            <groupId>org.jboss.as</groupId>\n+            <artifactId>jboss-as-clustering-web-infinispan</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.jboss.marshalling</groupId>\n+            <artifactId>jboss-marshalling-river</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.mockito</groupId>\n+            <artifactId>mockito-all</artifactId>\n+            <scope>test</scope>\n+        </dependency>\n     </dependencies>\n+    \n+    <profiles>\n+        <profile>\n+            <id>default</id>\n+            <activation><activeByDefault>true</activeByDefault></activation>\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-surefire-plugin</artifactId>\n+                        <configuration>\n+                            <excludes>\n+                                <exclude>**/web/session/*TestCase.java</exclude>\n+                            </excludes>\n+                            <enableAssertions>false</enableAssertions>\n+                        </configuration>\n+                    </plugin>\n+                </plugins>\n+            </build>\n+        </profile>\n+        <profile>\n+            <id>clustering</id>\n+            <activation><activeByDefault>false</activeByDefault></activation>\n+            <build>\n+                <plugins>\n+                    <plugin>\n+                        <groupId>org.apache.maven.plugins</groupId>\n+                        <artifactId>maven-surefire-plugin</artifactId>\n+                        <configuration>\n+                            <enableAssertions>false</enableAssertions>\n+                        </configuration>\n+                    </plugin>\n+                </plugins>\n+            </build>\n+        </profile>\n+    </profiles>\n </project>","filename":"web/pom.xml"},{"diff":"@@ -21,8 +21,6 @@\n  */\n package org.jboss.as.web.deployment;\n \n-// $Id: JBossContextConfig.java 104399 2010-05-03 20:50:38Z remy.maucherat@jboss.com $\n-\n import java.util.ArrayList;\n import java.util.Collection;\n import java.util.HashSet;\n@@ -59,9 +57,12 @@\n import org.apache.naming.resources.ProxyDirContext;\n import org.apache.tomcat.util.IntrospectionUtils;\n import org.jboss.annotation.javaee.Icon;\n+import org.jboss.as.clustering.web.ClusteringNotSupportedException;\n+import org.jboss.as.clustering.web.OutgoingDistributableSessionData;\n import org.jboss.as.server.deployment.Attachments;\n import org.jboss.as.server.deployment.DeploymentUnit;\n import org.jboss.as.web.deployment.helpers.VFSDirContext;\n+import org.jboss.as.web.session.DistributableSessionManager;\n import org.jboss.logging.Logger;\n import org.jboss.metadata.javaee.spec.DescriptionGroupMetaData;\n import org.jboss.metadata.javaee.spec.ParamValueMetaData;\n@@ -112,7 +113,6 @@\n import org.jboss.modules.Module;\n import org.jboss.modules.ModuleClassLoader;\n import org.jboss.modules.ModuleIdentifier;\n-import org.jboss.modules.ModuleLoadException;\n import org.jboss.vfs.VirtualFile;\n \n /**\n@@ -134,6 +134,7 @@ public JBossContextConfig(DeploymentUnit deploymentUnitContext) {\n         this.deploymentUnitContext = deploymentUnitContext;\n     }\n \n+    @Override\n     public void lifecycleEvent(LifecycleEvent event) {\n         if (event.getType().equals(Lifecycle.AFTER_START_EVENT)) {\n             // Invoke ServletContainerInitializer\n@@ -158,12 +159,14 @@ public void lifecycleEvent(LifecycleEvent event) {\n         super.lifecycleEvent(event);\n     }\n \n+    @Override\n     protected void applicationWebConfig() {\n         final WarMetaData warMetaData = deploymentUnitContext.getAttachment(WarMetaData.ATTACHMENT_KEY);\n         processJBossWebMetaData(warMetaData.getMergedJBossWebMetaData());\n         processWebMetaData(warMetaData.getMergedJBossWebMetaData());\n     }\n \n+    @Override\n     protected void defaultWebConfig() {\n         JBossWebMetaData sharedJBossWebMetaData = new JBossWebMetaData();\n         final WarMetaData warMetaData = deploymentUnitContext.getAttachment(WarMetaData.ATTACHMENT_KEY);\n@@ -270,8 +273,14 @@ else if (metaData.is23())\n         }\n \n         // Distributable\n-        if (metaData.getDistributable() != null)\n-            context.setDistributable(true);\n+        if (metaData.getDistributable() != null) {\n+            try {\n+                context.setManager(new DistributableSessionManager<OutgoingDistributableSessionData>(this.context.getParent(), metaData, this.deploymentUnitContext.getServiceRegistry()));\n+                context.setDistributable(true);\n+            } catch (ClusteringNotSupportedException e) {\n+                log.warn(\"Clustering not supported, falling back to non-clustered session manager.\", e);\n+            }\n+        }\n \n         // Context params\n         List<ParamValueMetaData> contextParams = metaData.getContextParams();\n@@ -554,12 +563,13 @@ else if (metaData.is23())\n     /**\n      * Process a \"init\" event for this Context.\n      */\n+    @Override\n     protected void init() {\n         context.setConfigured(false);\n         ok = true;\n-        // FIXME: Add clustered manager support\n     }\n \n+    @Override\n     protected void destroy() {\n     }\n \n@@ -567,6 +577,7 @@ protected void destroy() {\n      * Migrate TLD metadata to Catalina. This is separate, and is not subject to\n      * the order defined.\n      */\n+    @Override\n     protected void applicationTldConfig() {\n         final TldsMetaData tldsMetaData = deploymentUnitContext.getAttachment(TldsMetaData.ATTACHMENT_KEY);\n         if (tldsMetaData == null) {\n@@ -750,14 +761,17 @@ protected void processTld(ArrayList<TagLibraryInfo> tagLibraries, String locatio\n         }\n     }\n \n+    @Override\n     public void applicationServletContainerInitializerConfig() {\n         // Do nothing here\n     }\n \n+    @Override\n     protected void createFragmentsOrder() {\n         // Do nothing here\n     }\n \n+    @Override\n     protected void applicationExtraDescriptorsConfig() {\n         // Do nothing here\n     }\n@@ -837,6 +851,7 @@ protected void resolveAnnotations(JBossAnnotationsMetaData annotations) {\n         }\n     }\n \n+    @Override\n     protected void completeConfig() {\n         final WarMetaData warMetaData = deploymentUnitContext.getAttachment(WarMetaData.ATTACHMENT_KEY);\n         JBossWebMetaData metaData = warMetaData.getMergedJBossWebMetaData();\n@@ -907,5 +922,4 @@ protected void completeConfig() {\n         }\n \n     }\n-\n }","filename":"web/src/main/java/org/jboss/as/web/deployment/JBossContextConfig.java"},{"diff":"@@ -22,10 +22,21 @@\n \n package org.jboss.as.web.deployment;\n \n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import javax.servlet.ServletContext;\n+\n import org.apache.catalina.Loader;\n import org.apache.catalina.Realm;\n import org.apache.catalina.core.StandardContext;\n import org.apache.catalina.startup.ContextConfig;\n+import org.jboss.as.clustering.web.DistributedCacheManagerFactory;\n import org.jboss.as.ee.component.EEModuleDescription;\n import org.jboss.as.naming.context.NamespaceContextSelector;\n import org.jboss.as.security.plugins.SecurityDomainContext;\n@@ -40,6 +51,7 @@\n import org.jboss.as.web.WebSubsystemServices;\n import org.jboss.as.web.deployment.component.ComponentInstantiator;\n import org.jboss.as.web.security.JBossWebRealmService;\n+import org.jboss.as.web.session.DistributableSessionManager;\n import org.jboss.metadata.web.jboss.JBossWebMetaData;\n import org.jboss.metadata.web.jboss.ValveMetaData;\n import org.jboss.modules.Module;\n@@ -53,15 +65,6 @@\n import org.jboss.security.SecurityUtil;\n import org.jboss.vfs.VirtualFile;\n \n-import javax.servlet.ServletContext;\n-import java.io.IOException;\n-import java.util.ArrayList;\n-import java.util.Collection;\n-import java.util.Collections;\n-import java.util.List;\n-import java.util.Map;\n-import java.util.Set;\n-\n /**\n  * @author Emanuel Muckenhuber\n  * @author Anil.Saldhana@redhat.com\n@@ -217,11 +220,15 @@ protected void processDeployment(final String hostName, final WarMetaData warMet\n \n             builder.addDependencies(deploymentUnit.getAttachmentList(Attachments.WEB_DEPENDENCIES));\n \n+            if (metaData.getDistributable() != null) {\n+                DistributedCacheManagerFactory factory = DistributableSessionManager.getDistributedCacheManagerFactory();\n+                if (factory != null) {\n+                    builder.addDependencies(factory.getDependencies(metaData));\n+                }\n+            }\n             builder.install();\n-\n         } catch (ServiceRegistryException e) {\n             throw new DeploymentUnitProcessingException(\"Failed to add JBoss web deployment service\", e);\n         }\n     }\n-\n }","filename":"web/src/main/java/org/jboss/as/web/deployment/WarDeploymentProcessor.java"},{"diff":"@@ -41,52 +41,52 @@\n     /**\n      * jboss-web.xml metadata.\n      */\n-    private JBossWebMetaData jbossWebMetaData;\n+    private volatile JBossWebMetaData jbossWebMetaData;\n \n     /**\n      * Main web.xml metadata.\n      */\n-    private WebMetaData webMetaData;\n+    private volatile WebMetaData webMetaData;\n \n     /**\n      * Shared web.xml metadata.\n      */\n-    private WebMetaData sharedWebMetaData;\n+    private volatile WebMetaData sharedWebMetaData;\n \n     /**\n      * Web fragments metadata.\n      */\n-    private Map<String, WebFragmentMetaData> webFragmentsMetaData;\n+    private volatile Map<String, WebFragmentMetaData> webFragmentsMetaData;\n \n     /**\n      * Annotations metadata.\n      */\n-    private Map<String, WebMetaData> annotationsMetaData;\n+    private volatile Map<String, WebMetaData> annotationsMetaData;\n \n     /**\n      * Order.\n      */\n-    private List<String> order;\n+    private volatile List<String> order;\n \n     /**\n      * No order flag.\n      */\n-    private boolean noOrder = false;\n+    private volatile boolean noOrder = false;\n \n     /**\n      * Overlays.\n      */\n-    private Set<VirtualFile> overlays;\n+    private volatile Set<VirtualFile> overlays;\n \n     /**\n      * SCIs.\n      */\n-    private Map<String, VirtualFile> scis;\n+    private volatile Map<String, VirtualFile> scis;\n \n     /**\n      * Final merged metadata.\n      */\n-    private JBossWebMetaData mergedJBossWebMetaData;\n+    private volatile JBossWebMetaData mergedJBossWebMetaData;\n \n     public JBossWebMetaData getJbossWebMetaData() {\n         return jbossWebMetaData;","filename":"web/src/main/java/org/jboss/as/web/deployment/WarMetaData.java"},{"diff":"@@ -22,7 +22,6 @@\n package org.jboss.as.web.deployment;\n \n import org.apache.catalina.Context;\n-import org.apache.catalina.Host;\n import org.jboss.as.web.VirtualHost;\n import org.jboss.msc.inject.InjectionException;\n import org.jboss.msc.inject.Injector;","filename":"web/src/main/java/org/jboss/as/web/deployment/WebContextInjector.java"}],"id":"b815d73fa7028300ee706c7dcfdffff13d6fb8d2"}}