{"commit":{"author":{"login":"dobozysaurus","name":"Mike Dobozy","email":"dobozysaurus@gmail.com"},"url":"/jbossas/jboss-as/commit/669bb600bdb403c77fc0c5d5298467df6781a8cf","id":"669bb600bdb403c77fc0c5d5298467df6781a8cf","parents":[{"id":"0b0c78efce8e2acae841d928138b56edd3f11f81"}],"message":"edited based on feedback from bstansberry","tree":"48274f557bdd33d7718baec2f04494768f90db1e","modified":[{"diff":"@@ -182,7 +182,8 @@ private URI getBinding(String socketBinding) {\n     }\n \n     private String getInterface(String name) {\n-        return rootNode.get(\"interface\").get(name).get(\"criteria\").asList().get(0).get(\"inet-address\").asString();\n+        ModelNode node = rootNode.get(\"interface\").get(name).get(\"criteria\").asList().get(0).get(\"inet-address\");\n+        return node.resolve().asString();\n     }\n \n ","filename":"arquillian/common/src/main/java/org/jboss/as/arquillian/container/ManagementClient.java"},{"diff":"@@ -271,10 +271,10 @@\n \n     <interfaces>\n         <interface name=\"management\">\n-            <inet-address value=\"127.0.0.1\"/>\n+            <inet-address value=\"${jboss.bind.address.management:127.0.0.1}\"/>\n         </interface>\n         <interface name=\"public\">\n-           <inet-address value=\"127.0.0.1\"/>\n+           <inet-address value=\"${jboss.bind.address.public:127.0.0.1}\"/>\n         </interface>\n     </interfaces>\n ","filename":"build/src/main/resources/standalone/configuration/standalone.xml"},{"diff":"@@ -210,7 +210,8 @@ private static InterfaceCriteria parsePropertyCriteria(ModelNode node) {\n             case INET_ADDRESS: {\n                 checkStringType(prop.getValue(), element.getLocalName(), true);\n                 try {\n-                    InetAddress address = InetAddress.getByName(prop.getValue().asString());\n+                    String rawAddress = prop.getValue().resolve().asString();\n+                    InetAddress address = InetAddress.getByName(rawAddress);\n                     if (address.isAnyLocalAddress()) {\n                         // they've entered a wildcard address\n                         return new WildcardInetAddressInterfaceCriteria(address);","filename":"controller/src/main/java/org/jboss/as/controller/interfaces/ParsedInterfaceCriteria.java"},{"diff":"@@ -177,7 +177,7 @@ public static ServerEnvironment determineEnvironment(String[] args, Properties s\n                 } else if (arg.startsWith(\"-b\")) {\n                     String value = args[++i];\n                     String logicalName = \"-b\".equals(arg) ? \"public\" : arg.substring(2);\n-                    SecurityActions.setSystemProperty(ServerEnvironment.NETWORK_IP_PREFIX + logicalName, value);\n+                    SecurityActions.setSystemProperty(ServerEnvironment.JBOSS_BIND_ADDRESS_PREFIX + logicalName, value);\n                 } else {\n                     System.err.printf(\"Invalid option '%s'\\n\", arg);\n                     usage();","filename":"server/src/main/java/org/jboss/as/server/Main.java"},{"diff":"@@ -169,9 +169,9 @@\n     public static final String BOOTSTRAP_MAX_THREADS = \"org.jboss.server.bootstrap.maxThreads\";\n \n     /**\n-     * Prefix for the system property used to store bind information from the command-line (-b).\n+     * Prefix for the system property used to store bind address information from the command-line (-b).\n      */\n-    public static final String NETWORK_IP_PREFIX = \"jboss.network.ip.\";\n+    public static final String JBOSS_BIND_ADDRESS_PREFIX = \"jboss.bind.address.\";\n \n     private final LaunchType launchType;\n     private final String qualifiedHostName;\n@@ -412,10 +412,6 @@ public LaunchType getLaunchType() {\n         return launchType;\n     }\n \n-    public static String getNetworkBinding(String logicalName) {\n-        return SecurityActions.getSystemProperty(NETWORK_IP_PREFIX + logicalName);\n-    }\n-\n     public boolean isStandalone() {\n         return standalone;\n     }","filename":"server/src/main/java/org/jboss/as/server/ServerEnvironment.java"},{"diff":"@@ -34,11 +34,9 @@\n import java.util.HashSet;\n import java.util.Set;\n \n-import org.jboss.as.controller.interfaces.InetAddressMatchInterfaceCriteria;\n import org.jboss.as.controller.interfaces.InterfaceCriteria;\n import org.jboss.as.controller.interfaces.ParsedInterfaceCriteria;\n import org.jboss.as.network.NetworkInterfaceBinding;\n-import org.jboss.as.server.ServerEnvironment;\n import org.jboss.logging.Logger;\n import org.jboss.msc.service.Service;\n import org.jboss.msc.service.ServiceName;\n@@ -107,28 +105,6 @@ public static NetworkInterfaceBinding createBinding(String name, ParsedInterface\n \n     static NetworkInterfaceBinding createBinding(final String name, final boolean anyLocalV4, final boolean anyLocalV6,\n             final boolean anyLocal, final InterfaceCriteria criteria) throws SocketException, UnknownHostException {\n-\n-        // Begin check for -b information (AS7-1668)\n-        String argBinding = ServerEnvironment.getNetworkBinding(name);\n-        log.debugf(\"The argument binding for logical interface %s is %s\\n\", name, argBinding);\n-        if (argBinding != null && !argBinding.trim().isEmpty()) {\n-            InetAddress address = InetAddress.getByName(argBinding);\n-            if (address.isAnyLocalAddress()) {\n-                log.infof(\"Logical interface %s bound to any address.\\n\", name);\n-                if (address instanceof Inet4Address) {\n-                    return getNetworkInterfaceBinding(IPV4_ANYLOCAL);\n-                } else if (address instanceof Inet6Address) {\n-                    return getNetworkInterfaceBinding(IPV6_ANYLOCAL);\n-                } else {\n-                    throw new IllegalArgumentException(\"Unrecognized inet address: \" + argBinding);\n-                }\n-            } else {\n-                InetAddressMatchInterfaceCriteria argCriteria = new InetAddressMatchInterfaceCriteria(argBinding);\n-                return resolveInterface(argCriteria);\n-            }\n-        }\n-        // End check for AS7-1668\n-\n         if (anyLocalV4) {\n             return getNetworkInterfaceBinding(IPV4_ANYLOCAL);\n         } else if (anyLocalV6) {","filename":"server/src/main/java/org/jboss/as/server/services/net/NetworkInterfaceService.java"}],"committer":{"login":"bstansberry","name":"bstansberry@jboss.com","email":"brian.stansberry@redhat.com"},"committed_date":"2011-09-09T07:12:54-07:00","authored_date":"2011-09-06T16:53:30-07:00"}}